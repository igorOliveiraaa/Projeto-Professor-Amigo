<!DOCTYPE html> 
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mundo do Aprendizado</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body class="gradient-background p-6">
    <header class="text-center mb-8">
        <h1 class="text-4xl font-bold text-purple-800 flex items-center justify-center gap-2">
            <i class="fas fa-stars text-yellow-500"></i>
            Mundo do Aprendizado
            <i class="fas fa-stars text-yellow-500"></i>
        </h1>
    </header>

    <!-- Seção Principal -->
    <div id="mainSection" class="max-w-4xl mx-auto">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="card button-gradient-blue text-white">
                <div class="flex flex-col items-center gap-4">
                    <i class="fas fa-question-circle text-4xl"></i>
                    <h2 class="text-2xl font-bold">Tire suas Dúvidas</h2>
                    <p class="text-center">Escolha uma matéria e faça suas perguntas!</p>
                    <button onclick="showSection('subjects')"
                        class="mt-4 bg-white text-blue-600 px-6 py-2 rounded-full font-bold hover:bg-blue-50">
                        Começar
                    </button>
                </div>
            </div>

            <div class="card button-gradient-purple text-white">
                <div class="flex flex-col items-center gap-4">
                    <i class="fas fa-book text-4xl"></i>
                    <h2 class="text-2xl font-bold">Crie Histórias</h2>
                    <p class="text-center">Invente histórias mágicas e divertidas!</p>
                    <button onclick="showSection('story')"
                        class="mt-4 bg-white text-purple-600 px-6 py-2 rounded-full font-bold hover:bg-purple-50">
                        Começar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Seção de Matérias -->
    <div id="subjectsSection" class="max-w-4xl mx-auto hidden">
        <button onclick="showSection('main')"
            class="mb-6 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600" id="btn-voltar">
            Voltar
        </button>

        <div id="subjectsList" class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <!-- Matérias existentes -->
            <div class="subject-card math" onclick="selectSubject('Matemática')">
                <i class="fas fa-calculator text-2xl mb-2"></i>
                <h3 class="text-xl font-bold">Matemática</h3>
            </div>
            <div class="subject-card history" onclick="selectSubject('História')">
                <i class="fas fa-clock text-2xl mb-2"></i>
                <h3 class="text-xl font-bold">História</h3>
            </div>
            <div class="subject-card science" onclick="selectSubject('Ciências')">
                <i class="fas fa-flask text-2xl mb-2"></i>
                <h3 class="text-xl font-bold">Ciências</h3>
            </div>
            <div class="subject-card portuguese" onclick="selectSubject('Português')">
                <i class="fas fa-book-open text-2xl mb-2"></i>
                <h3 class="text-xl font-bold">Português</h3>
            </div>
            <!-- Novas matérias -->
            <div class="subject-card geography" onclick="selectSubject('Geografia')">
                <i class="fas fa-globe text-2xl mb-2"></i>
                <h3 class="text-xl font-bold">Geografia</h3>
            </div>
            <div class="subject-card physical-education" onclick="selectSubject('Educação Física')">
                <i class="fas fa-running text-2xl mb-2"></i>
                <h3 class="text-xl font-bold">Educação Física</h3>
            </div>
            <div class="subject-card english" onclick="selectSubject('Inglês')">
                <i class="fas fa-language text-2xl mb-2"></i>
                <h3 class="text-xl font-bold">Inglês</h3>
            </div>
            <div class="subject-card art" onclick="selectSubject('Arte')">
                <i class="fas fa-palette text-2xl mb-2"></i>
                <h3 class="text-xl font-bold">Arte</h3>
            </div>
        </div>

        <div id="questionArea" class="hidden card mt-6">
            <h2 id="questionTitle" class="text-2xl font-bold text-purple-600 mb-4"></h2>
            <textarea id="questionInput" placeholder="Digite sua pergunta aqui..."
                class="w-full p-4 border-2 border-purple-300 rounded-lg mb-4 h-32"></textarea>
            <div class="flex justify-between">
                <button onclick="backToSubjects()"
                    class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600">
                    Voltar
                </button>
                <button onclick="submitQuestion()" id="submitQuestionBtn"
                    class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">
                    Enviar Pergunta
                </button>
            </div>
            <div id="questionResponse" class="response-area hidden"></div>
        </div>
    </div>

    <!-- Seção de Histórias -->
    <div id="storySection" class="max-w-4xl mx-auto hidden">
        <button onclick="showSection('main')"
            class="mb-6 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">
            Voltar
        </button>

        <div class="card">
            <h2 class="text-2xl font-bold text-purple-600 mb-6">
                <i class="fas fa-book-reader mr-2"></i>
                Crie sua História
            </h2>

            <div class="space-y-4">
                <div>
                    <label class="block text-purple-600 font-bold mb-2">
                        Quantos personagens tem sua história?
                    </label>
                    <input type="number" id="charactersCount" class="w-full p-3 border-2 border-purple-300 rounded-lg"
                        min="1" max="5">
                </div>

                <div>
                    <label class="block text-purple-600 font-bold mb-2">
                        Quais são os nomes dos personagens?
                    </label>
                    <input type="text" id="characterNames" class="w-full p-3 border-2 border-purple-300 rounded-lg"
                        placeholder="Ex: João, Maria, Pedro">
                </div>

                <div>
                    <label class="block text-purple-600 font-bold mb-2">
                        Onde a história acontece?
                    </label>
                    <input type="text" id="storySetting" class="w-full p-3 border-2 border-purple-300 rounded-lg"
                        placeholder="Ex: floresta encantada, escola mágica">
                </div>

                <div>
                    <label class="block text-purple-600 font-bold mb-2">
                        Sobre o que é sua história?
                    </label>
                    <input type="text" id="storyTheme" class="w-full p-3 border-2 border-purple-300 rounded-lg"
                        placeholder="Ex: uma aventura espacial, um mistério na escola">
                </div>

                <!-- Novos inputs para o público infantil -->
                <div>
                    <label class="block text-purple-600 font-bold mb-2">
                        Qual é o gênero da história?
                    </label>
                    <input type="text" id="storyGenre" class="w-full p-3 border-2 border-purple-300 rounded-lg"
                        placeholder="Ex: aventura, fantasia, mistério">
                </div>

                <div>
                    <label class="block text-purple-600 font-bold mb-2">
                        O que os personagens gostam de fazer?
                    </label>
                    <input type="text" id="charactersHobbies" class="w-full p-3 border-2 border-purple-300 rounded-lg"
                        placeholder="Ex: jogar futebol, explorar florestas, pintar">
                </div>

                <div>
                    <label class="block text-purple-600 font-bold mb-2">
                        Há algum objeto mágico na história?
                    </label>
                    <input type="text" id="magicObject" class="w-full p-3 border-2 border-purple-300 rounded-lg"
                        placeholder="Ex: uma varinha mágica, um mapa do tesouro">
                </div>

                <div>
                    <label class="block text-purple-600 font-bold mb-2">
                        Qual é o desafio ou problema que os personagens enfrentam?
                    </label>
                    <input type="text" id="storyChallenge" class="w-full p-3 border-2 border-purple-300 rounded-lg"
                        placeholder="Ex: salvar a floresta, encontrar um amigo perdido">
                </div>

                <div>
                    <label class="block text-purple-600 font-bold mb-2">
                        Qual é a moral ou lição da história?
                    </label>
                    <input type="text" id="storyMoral" class="w-full p-3 border-2 border-purple-300 rounded-lg"
                        placeholder="Ex: a importância da amizade, nunca desistir">
                </div>

                <button onclick="generateStory()" id="generateStoryBtn"
                    class="w-full px-4 py-3 bg-purple-500 text-white rounded-lg hover:bg-purple-600 font-bold mt-4">
                    Criar História Mágica
                </button>

                <div id="storyResponse" class="response-area hidden"></div>
            </div>
        </div>
    </div>

    <script>
        // Configuração da API Groq
        const GROQ_API_KEY = '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';
        let currentSubject = '';

        // Funções de navegação
        function showSection(sectionName) {
            document.getElementById('mainSection').classList.add('hidden');
            document.getElementById('subjectsSection').classList.add('hidden');
            document.getElementById('storySection').classList.add('hidden');

            document.getElementById(`${sectionName}Section`).classList.remove('hidden');

            // Reset responses
            document.getElementById('questionResponse').classList.add('hidden');
            document.getElementById('storyResponse').classList.add('hidden');
        }

        function selectSubject(subject) {
            currentSubject = subject;
            document.getElementById('subjectsList').classList.add('hidden');
            document.getElementById('questionArea').classList.remove('hidden');
            document.getElementById('btn-voltar').classList.add('hidden');
            document.getElementById('questionTitle').textContent = `Tire suas dúvidas de ${subject}`;
        }

        function backToSubjects() {
            document.getElementById('btn-voltar').classList.remove('hidden');
            document.getElementById('subjectsList').classList.remove('hidden');
            document.getElementById('questionArea').classList.add('hidden');
            document.getElementById('questionResponse').classList.add('hidden');
        }

        // Funções de chamada à API
        async function callGroqAPI(prompt, isStory = false) {
            const button = isStory ? 'generateStoryBtn' : 'submitQuestionBtn';
            const responseArea = isStory ? 'storyResponse' : 'questionResponse';

            document.getElementById(button).innerHTML = '<i class="fas fa-spinner loading"></i> Pensando...';
            document.getElementById(button).disabled = true;

            try {
                const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${GROQ_API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: "mixtral-8x7b-32768",
                        messages: [{
                            role: "system",
                            content: isStory
                                ? "Você é um contador de histórias infantis criativo e amigável. Crie histórias apropriadas para crianças, divertidas e educativas. Certifique-se de que o conteúdo é adequado para jovens, evitando tópicos ou linguagens inapropriadas."
                                : "Você é um professor amigável que explica conceitos de forma simples e clara para crianças. Use analogias e exemplos do dia a dia. Certifique-se de que suas explicações são adequadas para a idade, evitando tópicos complexos ou adultos, e mantendo o conteúdo apropriado para crianças."
                        }, {
                            role: "user",
                            content: prompt
                        }],
                        temperature: isStory ? 0.8 : 0.5,
                        max_tokens: isStory ? 1024 : 512,
                    })
                });

                const data = await response.json();
                const content = data.choices[0].message.content;

                // Verificação básica para conteúdo apropriado
                if (content.toLowerCase().includes('inapropriado') || content.toLowerCase().includes('violência')) {
                    throw new Error('Conteúdo inapropriado detectado.');
                }

                const responseElement = document.getElementById(responseArea);
                responseElement.textContent = content;
                responseElement.classList.remove('hidden');
            } catch (error) {
                console.error('Erro ao chamar a API:', error);
                const responseElement = document.getElementById(responseArea);
                responseElement.textContent = 'Desculpe, tive um problema ao gerar a resposta. Pode tentar novamente?';
                responseElement.classList.remove('hidden');
            } finally {
                document.getElementById(button).innerHTML = isStory ? 'Criar História Mágica' : 'Enviar Pergunta';
                document.getElementById(button).disabled = false;
            }
        }

        async function submitQuestion() {
            const question = document.getElementById('questionInput').value.trim();
            if (!question) return;

            const prompt = `Por favor, explique de forma simples e amigável, como se estivesse falando com uma criança sobre ${currentSubject}: ${question}`;
            await callGroqAPI(prompt);
        }

        async function generateStory() {
            const characters = document.getElementById('charactersCount').value;
            const names = document.getElementById('characterNames').value;
            const setting = document.getElementById('storySetting').value;
            const theme = document.getElementById('storyTheme').value;
            const genre = document.getElementById('storyGenre').value;
            const hobbies = document.getElementById('charactersHobbies').value;
            const magicObject = document.getElementById('magicObject').value;
            const challenge = document.getElementById('storyChallenge').value;
            const moral = document.getElementById('storyMoral').value;

            if (!characters || !names || !setting || !theme || !genre || !hobbies || !magicObject || !challenge || !moral) {
                alert('Por favor, preencha todos os campos!');
                return;
            }

            const prompt = `Por favor, crie uma história infantil com os seguintes elementos:
            - Número de personagens: ${characters}
            - Nomes dos personagens: ${names}
            - Cenário: ${setting}
            - Tema: ${theme}
            - Gênero da história: ${genre}
            - O que os personagens gostam de fazer: ${hobbies}
            - Objeto mágico: ${magicObject}
            - Desafio ou problema: ${challenge}
            - Moral ou lição: ${moral}

            A história deve ser educativa, divertida e apropriada para crianças.`;

            await callGroqAPI(prompt, true);
        }
    </script>

    <style>
        /* Estilos personalizados */
        .gradient-background {
            background: linear-gradient(180deg, #c4b5fd 0%, #e9d5ff 100%);
            min-height: 100vh;
        }

        .card {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .button-gradient-blue {
            background: linear-gradient(45deg, #60a5fa, #3b82f6);
            transition: all 0.3s;
        }

        .button-gradient-purple {
            background: linear-gradient(45deg, #a78bfa, #8b5cf6);
            transition: all 0.3s;
        }

        .button-gradient-blue:hover,
        .button-gradient-purple:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .subject-card {
            padding: 1rem;
            border-radius: 0.75rem;
            color: white;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .subject-card:hover {
            transform: translateY(-5px);
        }

        .math {
            background-color: #ec4899;
        }

        .history {
            background-color: #8b5cf6;
        }

        .science {
            background-color: #10b981;
        }

        .portuguese {
            background-color: #3b82f6;
        }

        /* Novas cores para as matérias */
        .geography {
            background-color: #f59e0b;
        }

        .physical-education {
            background-color: #ef4444;
        }

        .english {
            background-color: #6366f1;
        }

        .art {
            background-color: #f472b6;
        }

        .loading {
            display: inline-block;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        .response-area {
            background-color: #f3e8ff;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
        }

        .hidden {
            display: none;
        }
    </style>
</body>

</html>
